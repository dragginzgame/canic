# ================================================================
#  CANIC CONFIGURATION
# ================================================================

# ----------------------------------------------------------------
# Global Settings
# ----------------------------------------------------------------
controllers = []
app_directory = ["user_hub", "scale_hub", "shard_hub"]

[app]
init_mode = "enabled"
[app.whitelist]

[auth.delegated_tokens]
# Root-signed delegated token auth (cert -> proof -> token).
enabled = true


# ----------------------------------------------------------------
# Standards
# ----------------------------------------------------------------

[standards]
icrc21 = true # Enable ICRC-21 capability

# ----------------------------------------------------------------
# Subnet Definitions
# ----------------------------------------------------------------
# Each subnet defines how its canisters behave and when they top up.
# ----------------------------------------------------------------

# ================================================================
#  PRIME SUBNET
# ================================================================
[subnets.prime]
auto_create = ["app", "user_hub", "scale_hub", "shard_hub", "test"]
subnet_directory = ["app", "user_hub", "scale_hub", "shard_hub", "test"]
pool.minimum_size = 3

# --- Root ---
[subnets.prime.canisters.root]
kind = "root"

# --- App ---
[subnets.prime.canisters.app]
kind = "singleton"

# --- User Hub ---
[subnets.prime.canisters.user_hub]
kind = "singleton"

# --- User Hub Pools ---
[subnets.prime.canisters.user_hub.sharding.pools.user_shards]
canister_role = "user_shard"
policy.capacity = 100
policy.max_shards = 4

# --- User Shard ---
[subnets.prime.canisters.user_shard]
kind = "shard"

# --- Blank ---
[subnets.prime.canisters.blank]
kind = "replica"

# --- Scale Hub ---
[subnets.prime.canisters.scale_hub]
kind = "singleton"
topup.threshold = "10T"
topup.amount = "5T"

# --- Scale Hub Pools ---
[subnets.prime.canisters.scale_hub.scaling.pools.scales]
canister_role = "scale"
policy.min_workers = 2

# --- Scale ---
[subnets.prime.canisters.scale]
kind = "replica"

# --- Shard Hub ---
[subnets.prime.canisters.shard_hub]
kind = "singleton"
topup.threshold = "10T"
topup.amount = "5T"

# --- Shard Hub Pools ---
[subnets.prime.canisters.shard_hub.sharding.pools.shards]
canister_role = "shard"
policy.capacity = 100
policy.max_shards = 4

# --- Shard ---
[subnets.prime.canisters.shard]
kind = "shard"
topup.threshold = "10T"
topup.amount = "5T"


# --- Test ---
[subnets.prime.canisters.test]
kind = "singleton"

# ================================================================
#  GENERAL SUBNET
# ================================================================
[subnets.general]

# --- Blank Canister ---
[subnets.general.canisters.blank]
kind = "replica"
