#!/usr/bin/env bash
set -euo pipefail

# Skip if no staged Rust or Cargo files
if ! git diff --cached --name-only --diff-filter=ACM | grep -E '\\.rs$|^Cargo\\.toml$|^Cargo\\.lock$' -q; then
  exit 0
fi

cargo fmt --all
cargo sort -w || true
cargo sort-derives || true
git add -u
